{"platform":{"name":"redhat","release":"9.4","target_id":"7fae06c2-057d-565e-80b1-95abe18a7e0e"},"profiles":[{"name":"redhat-enterprise-linux-9-stig-baseline","version":"1.2.2","sha256":"c22bf935b6269e1f250b67b04694489868283d0ce54a634f1f4ae3febf379e4c","title":"redhat-enterprise-linux-9-stig-baseline","maintainer":"MITRE SAF Team","summary":"InSpec profile aligned to DISA STIG for RHEL9","license":"Apache-2.0","copyright":"MITRE","supports":[{"platform-family":"redhat","release":"9.*"}],"attributes":[{"name":"sudoers_config_files","options":{"type":"Array","value":["/etc/sudoers","/etc/sudoers.d/*"]}},{"name":"passwordless_admins","options":{"type":"Array","value":[]}},{"name":"sshd_config_values","options":{"type":"Hash","value":{"GSSAPIAuthentication":"no","ClientAliveInterval":"600"}}},{"name":"alternate_mfa_method","options":{"type":"String","value":""}},{"name":"sssd_conf_files","options":{"type":"Array","value":["/etc/sssd/sssd.conf","/etc/sssd/conf.d/*.conf"]}},{"name":"ssh_host_key_dirs","options":{"type":"Array","value":["/etc/ssh/","/home/"]}},{"name":"ssh_pub_key_mode","options":{"type":"String","value":"0644"}},{"name":"ssh_private_key_mode","options":{"type":"String","value":"0640"}},{"name":"audit_conf_mode","options":{"type":"String","value":"0640"}},{"name":"audit_tool_mode","options":{"type":"String","value":"0755"}},{"name":"expected_modes","options":{"type":"Hash","value":{"home_dirs":"0750","cron_dirs":"0700","/etc/group":"0644","/etc/group-":"0644","/etc/gshadow":"0000","/etc/gshadow-":"0000","/etc/passwd":"0644","/etc/passwd-":"0644","/etc/shadow":"0000","/etc/shadow-":"0000","/etc/crontab":"0600","/etc/ssh/sshd_config":"0600","auditd_conf":"0640"}}},{"name":"initialization_file_mode","options":{"type":"String","value":"0740"}},{"name":"exempt_ini_files","options":{"type":"Array","value":[]}},{"name":"alternate_ini_file_dirs","options":{"type":"Array","value":[]}},{"name":"alert_method","options":{"type":"String","value":"email"}},{"name":"peripherals_package","options":{"type":"String","value":"usbguard"}},{"name":"peripherals_service","options":{"type":"String","value":"usbguard"}},{"name":"allow_container_openssh_server","options":{"type":"Boolean","value":false}},{"name":"maxclassrepeat","options":{"type":"Numeric","value":4}},{"name":"maxrepeat","options":{"type":"Numeric","value":3}},{"name":"minclass","options":{"type":"Numeric","value":4}},{"name":"difok","options":{"type":"Numeric","value":8}},{"name":"pass_min_days","options":{"type":"Numeric","value":1}},{"name":"pass_max_days","options":{"type":"Numeric","value":60}},{"name":"exempt_separate_filesystem","options":{"type":"Boolean","value":false}},{"name":"disable_slow_controls","options":{"type":"Boolean","value":false}},{"name":"disconnected_system","options":{"type":"Boolean","value":false}},{"name":"use_fips","options":{"type":"Boolean","value":true}},{"name":"data_at_rest_exempt","options":{"type":"Boolean","value":false}},{"name":"system_wide_crypto_policy","options":{"type":"String","value":"FIPS"}},{"name":"min_reuse_generations","options":{"type":"Numeric","value":5}},{"name":"min_retry","options":{"type":"Numeric","value":3}},{"name":"pass_min_len","options":{"type":"Numeric","value":15}},{"name":"faillock_tally","options":{"type":"String","value":"faillog_t"}},{"name":"network_router","options":{"type":"Boolean","value":false}},{"name":"core_dump_expected_value","options":{"type":"Numeric","value":0}},{"name":"concurrent_sessions_permitted","options":{"type":"Numeric","value":10}},{"name":"grub_conf_path","options":{"type":"String","value":"/etc/grub2.cfg"}},{"name":"grub_user_conf_path","options":{"type":"String","value":"/boot/grub2/user.cfg"}},{"name":"disallowed_grub_superusers","options":{"type":"Array","value":["root","admin","administrator"]}},{"name":"exempt_home_users","options":{"type":"Array","value":["root"]}},{"name":"non_interactive_shells","options":{"type":"Array","value":["/sbin/nologin","/sbin/halt","/sbin/shutdown","/bin/false","/bin/sync","/bin/true"]}},{"name":"exempt_interactive_system_accounts","options":{"type":"Array","value":["root"]}},{"name":"user_accounts","options":{"type":"Array","value":[]}},{"name":"unapproved_ssl_tls_versions","options":{"type":"Array","value":["DTLS0.9","SSL3.0","TLS1.0","TLS1.1","DTLS1.0"]}},{"name":"ipv4_enabled","options":{"type":"Boolean","value":true}},{"name":"unsuccessful_attempts","options":{"type":"Numeric","value":3}},{"name":"ipv6_enabled","options":{"type":"Boolean","value":true}},{"name":"bluetooth_installed","options":{"type":"Boolean","value":true}},{"name":"known_system_accounts","options":{"type":"Array","value":["adm","bin","chrony","daemon","dbus","halt","lp","mail","nobody","ntp","operator","polkitd","postfix","root","shutdown","sshd","sssd","sync","systemd-bus-proxy","systemd-network"]}},{"name":"smart_card_enabled","options":{"type":"Boolean","value":false}},{"name":"file_integrity_tool","options":{"type":"String","value":"aide"}},{"name":"authoritative_timeservers","options":{"type":"Array","value":["0.us.pool.ntp.mil"]}},{"name":"match_all_authoritative_timeservers_enabled","options":{"type":"Boolean","value":true}},{"name":"non_removable_media_fs","options":{"type":"Array","value":["/","/tmp","none","/home","/tmpfs"]}},{"name":"private_key_files","options":{"type":"Array","value":[]}},{"name":"root_ca_file","options":{"type":"Hash","value":{"path":"/etc/sssd/pki/sssd_auth_ca_db.pem","issuer_dn":"/C=US/O=U.S. Government/OU=DoD/OU=PKI/CN=DoD Root CA 3","subject_dn":"/C=US/O=U.S. Government/OU=DoD/OU=PKI/CN=DoD Root CA 3"}}},{"name":"system_inactivity_timeout","options":{"type":"Numeric","value":600}},{"name":"days_of_inactivity","options":{"type":"Numeric","value":35}},{"name":"temporary_accounts","options":{"type":"Array","value":[]}},{"name":"temporary_account_max_days","options":{"type":"Numeric","value":3}},{"name":"banner_message_text_cli","options":{"type":"String","value":"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."}},{"name":"banner_message_text_ral","options":{"type":"String","value":"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."}},{"name":"banner_message_text_gui","options":{"type":"String","value":"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."}},{"name":"fail_interval","options":{"type":"Numeric","value":900}},{"name":"lockout_time","options":{"type":"Numeric","value":0}},{"name":"system_activity_timeout","options":{"type":"Numeric","value":600}},{"name":"log_directory","options":{"type":"String","value":"/var/log/faillock"}},{"name":"sshd_client_alive_count_max","options":{"type":"Numeric","value":1}},{"name":"linux_threat_prevention_package","options":{"type":"String","value":"mcafeetp"}},{"name":"linux_threat_prevention_service","options":{"type":"String","value":"mfetpd"}},{"name":"remove_xorg_x11_server_packages","options":{"type":"Array","value":["xorg-x11-server-common","xorg-x11-server-Xorg","xorg-x11-server-utils","xorg-x11-server-Xwayland"]}},{"name":"gui_required","options":{"type":"Boolean","value":false}},{"name":"disk_error_action","options":{"type":"Array","value":["SYSLOG","SINGLE","HALT"]}},{"name":"disk_full_action","options":{"type":"Array","value":["SYSLOG","SINGLE","HALT"]}},{"name":"admin_space_left","options":{"type":"String","value":"5%"}},{"name":"admin_space_left_action","options":{"type":"String","value":"SINGLE"}},{"name":"max_log_file_action","options":{"type":"String","value":"ROTATE"}},{"name":"audit_flush_threshold","options":{"type":"Numeric","value":100}},{"name":"permit_root_login","options":{"type":"String","value":"no"}},{"name":"modes_for_shells","options":{"type":"Hash","value":{"default_umask":"077","bashrc_umask":"077","cshrc_umask":"077","profile_umask":"077"}}},{"name":"mode_for_libs","options":{"type":"String","value":"0755"}},{"name":"system_libraries","options":{"type":"Array","value":["/lib","/lib64","/usr/lib","/usr/lib64"]}},{"name":"system_command_dirs","options":{"type":"Array","value":["/bin","/sbin","/usr/bin","/usr/sbin","/usr/libexec","/usr/local/bin","/usr/local/sbin"]}},{"name":"audit_tools","options":{"value":["/sbin/auditctl","/sbin/aureport","/sbin/ausearch","/sbin/autrace","/sbin/auditd","/sbin/rsyslogd","/sbin/augenrules"]}},{"name":"required_system_accounts","options":{"type":"Array","value":["root"]}},{"name":"var_log_messages_group","options":{"type":"Array","value":["root"]}},{"name":"sssd_certificate_verification","options":{"type":"String","value":"ocsp_dgst=sha1"}},{"name":"var_log_audit_group","options":{"type":"Array","value":["root"]}},{"name":"use_fapolicyd","options":{"type":"Boolean","value":true}},{"name":"pam_auth_files","options":{"type":"Hash","value":{"system-auth":"/etc/pam.d/system-auth","password-auth":"/etc/pam.d/password-auth","smartcard-auth":"/etc/pam.d/smartcard-auth"}}},{"name":"security_faillock_conf","options":{"type":"String","value":"/etc/security/faillock.conf"}},{"name":"external_firewall","options":{"type":"Boolean","value":false}},{"name":"firewalld_properties","options":{"type":"Hash","value":{"default_zone":"public","ports":[],"protocols":[],"services":["cockpit","dhcpv6-client","ssh"]}}},{"name":"mount_tmp_options","options":{"type":"Hash","value":{"nodev":false,"nosuid":false,"noexec":false}}},{"name":"mount_var_options","options":{"type":"Hash","value":{"nodev":true,"nosuid":true,"noexec":true}}},{"name":"skip_endpoint_security_tool","options":{"type":"Boolean","value":false}},{"name":"non_default_tally_dir","options":{"type":"String","value":"/var/log/faillock"}},{"name":"users_allowed_blank_passwords","options":{"type":"Array","value":[]}},{"name":"mail_package","options":{"type":"String","value":"s-nail"}},{"name":"rpm_gpg_file","options":{"type":"String","value":"/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"}},{"name":"rpm_gpg_keys","options":{"type":"Hash","value":{"release key 2":"567E 347A D004 4ADE 55BA  8A5F 199E 2F91 FD43 1D51","auxiliary key":"7E46 2425 8C40 6535 D56D  6F13 5054 E4A4 5A63 40B3"}}},{"name":"stop_idle_session_sec","options":{"type":"Numeric","value":900}},{"name":"login_prompt_delay","options":{"type":"Numeric","value":4}},{"name":"logging_conf_files","options":{"type":"Array","value":["/etc/rsyslog.conf","/etc/rsyslog.d/*.conf"]}},{"name":"alternative_logging","options":{"type":"Boolean","value":false}},{"name":"alternative_logging_method","options":{"type":"String","value":""}},{"name":"audit_storage_threshold","options":{"type":"Numeric","value":25}},{"name":"autofs_required","options":{"type":"Boolean","value":false}},{"name":"usb_storage_required","options":{"type":"Boolean","value":false}},{"name":"tftp_required","options":{"type":"Boolean","value":false}},{"name":"ftp_required","options":{"type":"Boolean","value":false}},{"name":"gssproxy_required","options":{"type":"Boolean","value":false}},{"name":"iprutils_required","options":{"type":"Boolean","value":false}},{"name":"tuned_required","options":{"type":"Boolean","value":false}},{"name":"kerberos_required","options":{"type":"Boolean","value":false}},{"name":"quagga_required","options":{"type":"Boolean","value":false}},{"name":"alternate_firewall_tool","options":{"type":"String","value":""}},{"name":"wifi_hardware","options":{"type":"Boolean","value":true}},{"name":"audit_rule_keynames","options":{"type":"Hash","value":{"execve":"execpriv","/etc/shadow":"identity","/etc/security/opasswd":"identity","/etc/passwd":"identity","/etc/gshadow":"identity","/etc/group":"identity","/etc/sudoers":"identity","/etc/sudoers.d":"identity","/usr/bin/su":"privileged-priv_change","setxattr":"perm_mod","fsetxattr":"perm_mod","lsetxattr":"perm_mod","removexattr":"perm_mod","fremovexattr":"perm_mod","lremovexattr":"perm_mod","/usr/bin/chage":"privileged-chage","/usr/bin/chcon":"perm_mod","/usr/bin/ssh-agent":"privileged-ssh","/usr/bin/passwd":"privileged-passwd","/usr/bin/mount":"privileged-mount","/usr/bin/umount":"privileged-mount","mount":"privileged-mount","umount":"privileged-umount","/usr/sbin/unix_update":"privileged-unix-update","/usr/sbin/postdrop":"privileged-unix-update","/usr/sbin/postqueue":"privileged-unix-update","/usr/sbin/semanage":"privileged-unix-update","/usr/sbin/setfiles":"privileged-unix-update","/usr/sbin/userhelper":"privileged-unix-update","/usr/sbin/setsebool":"privileged-unix-update","/usr/sbin/unix_chkpwd":"privileged-unix-update","/usr/libexec/openssh/ssh-keysign":"privileged-ssh","/usr/bin/setfacl":"perm_mod","/usr/sbin/pam_timestamp_check":"privileged-pam_timestamp_check","/usr/bin/newgrp":"priv_cmd","init_module":"module_chng","finit_module":"module_chng","rename":"delete","unlink":"delete","rmdir":"delete","renameat":"delete","unlinkat":"delete","/usr/bin/gpasswd":"privileged-gpasswd","delete_module":"module_chng","/usr/bin/crontab":"privileged-crontab","/usr/bin/chsh":"priv_cmd","truncate":"perm_access","ftruncate":"perm_access","creat":"perm_access","open":"perm_access","openat":"perm_access","open_by_handle_at":"perm_access","chown":"perm_mod","fchown":"perm_mod","fchownat":"perm_mod","lchown":"perm_mod","chmod":"perm_mod","fchmod":"perm_mod","fchmodat":"perm_mod","/usr/bin/sudo":"priv_cmd","/usr/sbin/usermod":"privileged-usermod","/usr/bin/chacl":"perm_mod","/usr/bin/kmod":"modules","/var/log/faillock":"logins","/var/log/lastlog":"logins","/usr/bin/sudoedit":"priv_cmd","/usr/sbin/init":"privileged-init","/usr/sbin/poweroff":"privileged-poweroff","/usr/sbin/reboot":"privileged-reboot","/usr/sbin/shutdown":"privileged-shutdown","umount2":"perm_mod","/var/log/tallylog":"logins"}}},{"name":"audit_rule_keynames_overrides","options":{"type":"Hash","value":{}}},{"name":"device_file_locations","options":{"type":"Array","value":["/dev"]}},{"name":"exempt_from_device_file_checks","options":{"type":"Array","value":["/dev/vmci"]}},{"name":"approved_ppsm_clsa","options":{"type":"Hash","value":{"ports":[],"protocols":[],"services":["ssh","cockpit","dhcpv6-client"]}}},{"name":"approved_openssh_server_conf","options":{"type":"Hash","value":{"ciphers":"aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr,aes128-gcm@openssh.com,aes128-ctr","macs":"hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,umac-128@openssh.com,hmac-sha2-512"}}},{"name":"approved_openssh_client_conf","options":{"type":"Hash","value":{"ciphers":"aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr,aes128-gcm@openssh.com,aes128-ctr","macs":"hmac-sha2-256-etm@openssh.com,hmac-sha2-256,hmac-sha2-512-etm@openssh.com,hmac-sha2-512"}}},{"name":"password_hash_rounds","options":{"type":"Numeric","value":5000}},{"name":"expected_panic_value","options":{"type":"Numeric","value":2}},{"name":"high_availability_required","options":{"type":"Boolean","value":false}},{"name":"approved_crypto_backend","options":{"type":"String","value":"/etc/crypto-policies/back-ends/libreswan.config"}},{"name":"expected_audit_backlog_limit","options":{"type":"Numeric","value":8192}},{"name":"send_redirects","options":{"type":"Boolean","value":false}},{"name":"forwarding","options":{"type":"Boolean","value":false}},{"name":"vsyscall_required","options":{"type":"Boolean","value":false}},{"name":"storing_core_dumps_required","options":{"type":"Boolean","value":false}},{"name":"core_dumps_required","options":{"type":"Boolean","value":false}},{"name":"atm_required","options":{"type":"Boolean","value":false}},{"name":"can_required","options":{"type":"Boolean","value":false}},{"name":"firewire_required","options":{"type":"Boolean","value":false}},{"name":"sctp_required","options":{"type":"Boolean","value":false}},{"name":"tipc_required","options":{"type":"Boolean","value":false}},{"name":"cramfs_required","options":{"type":"Boolean","value":false}},{"name":"bluetooth_required","options":{"type":"Boolean","value":false}},{"name":"accept_ra_required","options":{"type":"Boolean","value":false}},{"name":"x11_forwarding_required","options":{"type":"Boolean","value":false}},{"name":"gui_automount_required","options":{"type":"Boolean","value":false}},{"name":"gui_autorun_required","options":{"type":"Boolean","value":false}},{"name":"promiscuous_mode_permitted","options":{"type":"Boolean","value":false}}],"groups":[{"id":"controls/SV-272496.rb","controls":["SV-272496"]}],"controls":[{"id":"SV-272496","title":"RHEL 9 must elevate the SELinux context when an administrator calls the sudo command.","desc":"Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.\n\nThis requirement applies to operating systems performing security function verification/testing and/or systems and environments that require this functionality.\n\nPreventing nonprivileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.\n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Nonprivileged users are individuals who do not possess appropriate authorizations. Circumventing intrusion detection and prevention mechanisms or malicious code protection mechanisms are examples of privileged functions that require protection from nonprivileged users.","descriptions":[{"label":"default","data":"Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.\n\nThis requirement applies to operating systems performing security function verification/testing and/or systems and environments that require this functionality.\n\nPreventing nonprivileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.\n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Nonprivileged users are individuals who do not possess appropriate authorizations. Circumventing intrusion detection and prevention mechanisms or malicious code protection mechanisms are examples of privileged functions that require protection from nonprivileged users."},{"label":"check","data":"Verify that RHEL 9 elevates the SELinux context when an administrator calls the sudo command with the following command:\n\nThis command must be run as root:\n\n# grep -r sysadm_r /etc/sudoers /etc/sudoers.d\n%{designated_group_or_user_name} ALL=(ALL) TYPE=sysadm_t ROLE=sysadm_r ALL\n\nIf conflicting results are returned, this is a finding.\n\nIf a designated sudoers administrator group or account(s) is not configured to elevate the SELinux type and role to \"sysadm_t\" and \"sysadm_r\" with the use of the sudo command, this is a finding."},{"label":"fix","data":"Configure RHEL 9 to elevate the SELinux context when an administrator calls the sudo command.\n\nEdit a file in the \"/etc/sudoers.d\" directory with the following command:\n\n$ sudo visudo -f /etc/sudoers.d/<customfile>\n\nUse the following example to build the <customfile> in the /etc/sudoers.d directory to allow any administrator belonging to a designated sudoers admin group to elevate their SELinux context with the use of the sudo command:\n\n%{designated_group_or_user_name} ALL=(ALL) TYPE=sysadm_t ROLE=sysadm_r ALL\n\nRemove any configurations that conflict with the above from the following locations:\n \n/etc/sudoers\n/etc/sudoers.d/"}],"impact":0.5,"refs":[{"ref":"DPMS Target Red Hat Enterprise Linux 9"}],"tags":{"check_id":"C-76549r1069439_chk","severity":"medium","gid":"V-272496","rid":"SV-272496r1082184_rule","stig_id":"RHEL-09-431016","gtitle":"SRG-OS-000445-GPOS-00199","fix_id":"F-76453r1082183_fix","documentable":null,"legacy":["SV-70979","V-56719"],"cci":["CCI-002235"],"nist":["AC-6 (10)"]},"code":"control 'SV-272496' do\n  title 'RHEL 9 must elevate the SELinux context when an administrator calls the sudo command.'\n  desc 'Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.\n\nThis requirement applies to operating systems performing security function verification/testing and/or systems and environments that require this functionality.\n\nPreventing nonprivileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.\n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Nonprivileged users are individuals who do not possess appropriate authorizations. Circumventing intrusion detection and prevention mechanisms or malicious code protection mechanisms are examples of privileged functions that require protection from nonprivileged users.'\n  desc 'check', 'Verify that RHEL 9 elevates the SELinux context when an administrator calls the sudo command with the following command:\n\nThis command must be run as root:\n\n# grep -r sysadm_r /etc/sudoers /etc/sudoers.d\n%{designated_group_or_user_name} ALL=(ALL) TYPE=sysadm_t ROLE=sysadm_r ALL\n\nIf conflicting results are returned, this is a finding.\n\nIf a designated sudoers administrator group or account(s) is not configured to elevate the SELinux type and role to \"sysadm_t\" and \"sysadm_r\" with the use of the sudo command, this is a finding.'\n  desc 'fix', 'Configure RHEL 9 to elevate the SELinux context when an administrator calls the sudo command.\n\nEdit a file in the \"/etc/sudoers.d\" directory with the following command:\n\n$ sudo visudo -f /etc/sudoers.d/<customfile>\n\nUse the following example to build the <customfile> in the /etc/sudoers.d directory to allow any administrator belonging to a designated sudoers admin group to elevate their SELinux context with the use of the sudo command:\n\n%{designated_group_or_user_name} ALL=(ALL) TYPE=sysadm_t ROLE=sysadm_r ALL\n\nRemove any configurations that conflict with the above from the following locations:\n \n/etc/sudoers\n/etc/sudoers.d/'\n  impact 0.5\n  ref 'DPMS Target Red Hat Enterprise Linux 9'\n  tag check_id: 'C-76549r1069439_chk'\n  tag severity: 'medium'\n  tag gid: 'V-272496'\n  tag rid: 'SV-272496r1082184_rule'\n  tag stig_id: 'RHEL-09-431016'\n  tag gtitle: 'SRG-OS-000445-GPOS-00199'\n  tag fix_id: 'F-76453r1082183_fix'\n  tag 'documentable'\n  tag legacy: ['SV-70979', 'V-56719']\n  tag cci: ['CCI-002235']\n  tag nist: ['AC-6 (10)']\n\n  only_if('Control not applicable within a container without sudo enabled', impact: 0.0) do\n    !virtualization.system.eql?('docker')\n  end\n\n  describe command('grep -r sysadm_r /etc/sudoers /etc/sudoers.d') do\n    its('stdout.strip') { should match(/^\\s*%[\\w-]+\\s+ALL=\\(ALL\\)\\s+TYPE=sysadm_t\\s+ROLE=sysadm_r\\s+ALL/) }\n  end\nend\n","source_location":{"line":1,"ref":"./controls/SV-272496.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Command: `grep -r sysadm_r /etc/sudoers /etc/sudoers.d` stdout.strip is expected to match /^\\s*%[\\w-]+\\s+ALL=\\(ALL\\)\\s+TYPE=sysadm_t\\s+ROLE=sysadm_r\\s+ALL/","run_time":0.130343,"start_time":"2025-07-22T13:50:20-04:00","message":"expected \"\" to match /^\\s*%[\\w-]+\\s+ALL=\\(ALL\\)\\s+TYPE=sysadm_t\\s+ROLE=sysadm_r\\s+ALL/\nDiff:\n@@ -1 +1 @@\n-/^\\s*%[\\w-]+\\s+ALL=\\(ALL\\)\\s+TYPE=sysadm_t\\s+ROLE=sysadm_r\\s+ALL/\n+\"\"\n","resource_class":"command","resource_params":"[\"grep -r sysadm_r /etc/sudoers /etc/sudoers.d\"]","resource_id":"Command: `grep -r sysadm_r /etc/sudoers /etc/sudoers.d`"}],"status":"failed"}],"status":"loaded","status_message":""}],"statistics":{"duration":0.133171},"version":"6.8.24"}